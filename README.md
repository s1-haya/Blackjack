# Blackjack(MVC + OOP + TS)

## 説明
MVCとOOPを意識し、TSで作成したBlackjackです。

【基本用語】<br>
　OOP(Object-Oriented Programming) モノの作成と操作に基づいて構成されたプログラム<br>
　MVCモデル Model View Controllerの三つの役割に整理した概念のこと<br>
  &emsp;・Model: 表示や入力に関連しない処理<br>
  &emsp;・View: 表示や入力に関する処理<br>
  &emsp;・Controller: ViewとModelの橋渡し役<br>
　TS(TypeScript)　静的言語、JavaScriptを拡張した言語<br>

<img width="1429" alt="スクリーンショット 2022-11-28 16 22 13" src="https://user-images.githubusercontent.com/103574382/204220945-cc22dd0c-f8dd-4c8b-8dae-29059b852020.png">

## URL
https://s1-haya.github.io/Blackjack/

## 制作経緯
Recursion( https://recursionist.io/ )のカリキュラムにある課題<br>
 &emsp;課題の目的はMVCやOOP,Typescriptの知識をoutputすることです。<br>
 &emsp;Blackjackはカリキュラム内にあるMVCやソフトウェア開発,　またブラックジャックの基本的なModelの学習を元に制作しました。<br>

【基本用語】<br>
Recursion: アメリカの大学でよく用いられるCSのカリキュラムを元に作られたoutput教材<br>
CS: コンピューターサイエンスの略<br>
カリキュラム: 一定の教育の目的に合わせて教育内容と学習支援を総合的に計画したもの<br>
リファクタリング: 外部から見た時の挙動は変えずに、プログラムの内部構造を整理すること<br>

## 制作期間
ブラックジャック本体　2週間(2022年11月14〜27日）<br>
追加機能(主にカウンティングとペーシックストラテジー)と細かな修正　4日(28日,29日,30日, 12月1日）<br>

## 使用技術
HTML/CSS/Javascript/Typescript/<br>

## 工夫した点
### 1.設計
学習したMVCモデルを元に設計しました。<br>
MVCを起用した理由はコードのリファクタリング、拡張、ソフトウェア設計を容易にするためです。
Modelを設計する際、特に工夫した点は特にゲームの進行を管理するTableクラスの設計です。<br>
TableクラスはPlayer,Deck,Card,GameDecisionクラス全体を管理するクラスです。<br>
そうすることによって、それぞれのデータのアクセスが容易になるからです。<br>
結果、ゲームの進行が円滑に進み、データの管理も容易にすることができます。<br>

またOOPとTypescriptを起用した理由はコードの可読性やデータの保守性、拡張性の精度を上げるためです。<br>
特に工夫した点ははコードの可読性です。<br>
なぜなら、他の人に見せることが前提だからです。これは今回の開発にかかわらず仕事をする上でも同じことが言えると考えています。<br>
また、拡張性やリファクタリングが容易になるからです。それによって、データの保守性を維持することができます。<br>
例えば、classや関数の分割や関数の入出力の型を決めることによって他の人がコードを見たときに瞬時に理解しやすい状態にすることができ、データの管理がしやすくなります。<br>
### 2.ゲーム性(追加機能)
ブラックジャックの遊び方と追加機能の詳細:(https://github.com/s1-haya/Blackjack/blob/main/README.md#%E9%81%8A%E3%81%B3%E6%96%B9)<br>
追加機能はカウンティングとペーシックストラテジーです。<br>
これらはブラックジャックのゲームで実際に使われている戦略法です。<br>
工夫した点はeasyモードとhardのモードの難易度とカウンティングとペーシックストラテジーを取り入れたゲーム性です。<br>
具体的にはゲーム性は遊び方の特別ルール(https://github.com/s1-haya/Blackjack/blob/main/README.md#%E7%89%B9%E5%88%A5%E3%83%AB%E3%83%BC%E3%83%AB)に記載しています。<br>
取り入れた意図としてはブラックジャックの初心者、上級者関係なく遊べるかつ飽きさせないようなゲームにしたかったからです。<br>
また実際にベットしてる感覚を体験して欲しかったからです。<br>
基本実装のブラックジャックはチップが$0になる以外ゲームの終わりがありませんでした。<br>
またベットすることに関しても$5などの低いベットは賭けてるというワクワク感がないのであまり戦略的に使用されないのではないかと考えました。<br>
それらによって上級者またはほとんどユーザーはブラックジャックに対して飽きる印象が残るのではないかと考えました。<br>
そこで山札の設置、Round毎回にチップを減らす。また戦略法を取り入れることによって勝敗に対してより戦略的になり、
結果として、ブラックジャックに対して興味関心を持っていただけるのではないかと考えました。<br>

## 苦労した点
### 1.実行環境とデプロイ
今回初めてtypescriptを使用したので、初めての実行環境の作成やデプロイに3日ぐらい費やしました。<br>
特にデプロイに関してはネットに記載されているデプロイの仕方の内容がバラバラだったので、<br>
githubでtypescriptを使用している人の環境そのまま模倣しました。<br>
今回の経験を通して次回以降はよりスムーズにtypescriptの実行環境を作成できると思いました<br>
### 2.バグの修正
今回、制作時間の半分以上はバグの修正です。<br>
特にModelのバグがとても多かったです。<br>
アクションボタンを押した部分とそのボタンの内容が異なったり、Roundの結果と各プレーヤの状態が異なったりなどです。<br>
MVCを初めて取り組んだということもあり、Modelの全体の処理内容をデバックで数回しかテストをせずにViewやControllerにデータを渡していたため、バグを見つけるのにどこのMVCが原因なのなかわからず大変苦労しました。<br>
次回は一つ一つの関数の処理構造を確認するのは去ることながらModelの全体の処理構造を数回ではなく、意図した値が出ているかを確認し、バグの原因のあたりの範囲を狭めるように心がけようと思いました。<br>

## 今後の課題
BlackJack以外のカードゲームにも対応できるような設計。
## 今後の展望
他のカードゲームとの共通部分と異なる部分をそれぞれ分割しOOPを用いて設計していきます。

## 遊び方
カジノディーラーとプレイヤーの対戦型ゲームです。<br>

### 基本ルール<br>
カードの数字の合計が「21」に近い方が勝利します。<br>
betする前は手札の中身は分かりません。<br>
deal後、プレイヤーは2枚、ディーラーは1枚表示されます。<br>
stand,hit,double,surrender,autoのアクションボタンを用いて対戦します。<br>

「プレーヤー手札の合計がディーラーの手札の合計より大きい場合<br>
もしくはディーラーがbustした場合<br>
もしくはプレーヤーがblackjackの場合」<br>
&emsp;->プレーヤの勝利<br>

「プレーヤー手札の合計がディーラーの手札の合計より少ない場合<br>
もしくはプレーヤーがbustした場合<br>
もしくはプレーヤがsurrenderした場合」<br>
&emsp;->ディーラーの勝利<br>

【カードの数え方】<br>
「2～9」　      そのままの数字<br>
「10・J・Q・K」 "10"<br>
「A」         　"1" もしくは "11"(どちらでも良い)<br>

【基本用語】<br>
status: ディーラーまたは各プレーヤの動き<br>
chip: お金、$<br>
bet: $5,$20,$50,$100のボタンからchipを賭けること<br>
deal: betの合計を提示した後、ディーラーがカードを配ること<br>
stand: これ以上カードを引かないこと<br>
hit: カードをもう1枚引くこと<br>
double: 最初の2枚のカードからあと1枚だけを引くこと。bet額が2倍になること<br>
surrender: 降参すること。bet額が2分の1になること<br>
*auto: *ベーシックストラテジーに基づいたボタンのこと(詳細は特別ルール)<br>
blackjack: 最初の2枚のカードの合計が「21」であること(必ず"A"と"10"に相当するものが入る) bet額が1.5倍になること<br>
bust: カードの合計が「21」を超えること<br>
push: 引き分けのこと<br>

### 特別ルール<br>
Deck Roundが0になるまでカジノディーラーとプレイヤーは対戦します。<br>
プレーヤの残りのchipsによって勝敗が決まります。<br>
難易度はEasyとHardがあります。<br>

  「Deck Roundが終了時点でプレーヤーのチップが$200以上だった場合」<br>
  ->プレーヤの勝利<br>
 
  「Deck Roundが終了時点でプレーヤーのチップが$200以下だった場合<br>
  もしくはDeck Round時にプレーヤーのチップが$0以下の場合」<br>
  ->ディーラーの勝利」<br>

  ゲームの難易度はeasyとhardから選べます。<br>
  &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;easy&emsp;&emsp;&emsp;hard<br>
  Deck Round &nbsp;&emsp;3回　　　&nbsp;5回<br>
  毎ターン後に &emsp;-$10    &emsp;-$20<br>
  auto btn　 &emsp;&emsp;⭕️     　&emsp;&emsp;&emsp;❌<br>

  
 【基本用語】<br>
Deck: 山札(52枚) 8枚以下になると補充されます。<br>
Deck Round: 1Deckにつき1Deck Round<br>
カウンティング: 場に出ているカードをカウントし、記憶していくことによって、これから配られるカードを予測するという戦略法<br>
auto btn: ベーシックストラテジーに基づいた機能(ハードハンドとソフトハンド)<br>
ベーシックストラテジー: アクションボタンを決めるための基本戦略法(詳細: https://vegasdocs.com/blackjack/strategy.html ）<br>
ハードハンド: プレーヤーの手札に"A"がないベーシックストラテジーの表 <br>
&emsp;*例えば　プレーヤー 4,J ディーラー 6の場合&emsp;->s: stand<br>
ソフトハンド: プレーヤーの手札に"A"があるベーシックストラテジーの表 <br>
&emsp;*例えば　プレーヤー 4,A ディーラー 4の場合&emsp;->D: double<br>

